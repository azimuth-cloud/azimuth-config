
# Config for storing terraform state in S3
terraform_backend_type: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_TYPE') }}"

terraform_backend_config:
  bucket: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_BUCKET') }}"
  region: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_REGION') }}"
  key: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_KEY') }}"
  endpoint: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_ENDPOINT') }}"
  skip_credentials_validation: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_SKIP_CREDENTIALS_VALIDATION') }}"
  force_path_style: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_FORCE_PATH_STYLE') }}"
  skip_region_validation: "{{ lookup('ansible.builtin.env', 'AZIMUTH_TERRAFORM_BACKEND_S3_SKIP_REGION_VALIDATION') }}"

# Arcus-specific tweaks

# NOTE (sd109 2023-05-11): 
# Currently need larger vm.ska.cpu.general.eighth arcus flavor
# since Harbor deployment fails on 4GB RAM VM due to insufficient
# memory. Can probably reduce this requirement in future if we 
# disable Harbor or refine pod resource quotas.
infra_flavor_id: 5f9def81-c93f-4c1f-a521-3b810061ff6c